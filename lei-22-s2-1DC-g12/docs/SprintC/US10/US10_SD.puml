@startuml
autonumber
'hide footbox
actor "Administrator" as ADM

participant ":RegisterEmployeeUI" as UI
participant ":RegisterEmployeeController" as CTRL
participant ":App" as APP
participant "app:App" as App
participant "comp:Company" as COMP
participant "plat:Platform" as PLAT
participant "gre\n:RegisterEmployee" as RE
participant "emp: Employee" as EMP
participant "auth\n:AuthFacade" as AF
participant ":UserRoleStore" as URS
participant ":UserRoleMapper" as URM
participant "lRolesDTO\n: List<UserRoleDTO>" as lDTO
participant "sRoles\n: Set<UserRole>" as SR
participant "lor\n List<String> listOfRoles" as lor



activate ADM
'1
ADM -> UI : Starts registering a new employee
'2
activate UI
'2
UI -> CTRL : lor = getRoles()
activate CTRL
'3
CTRL -> APP : app = getInstance()
activate APP
deactivate APP
'4
CTRL -> App : comp = getCompany()
activate App
deactivate App
'5
CTRL -> COMP : plat = getPlatform()
activate COMP
deactivate COMP
'6
CTRL -> PLAT : gre = getRegisterEmployee()
activate PLAT
deactivate PLAT
'7
CTRL -> RE : lor = getRoles()
activate RE
RE -> AF : IRolesDTO = getUserRoles()
deactivate RE
activate AF
'8
AF -> URS : sRoles = getAll()
activate URS
deactivate URS
'9
AF -> URM :  toDTO(sRoles)
activate URM
deactivate URM
deactivate AF
deactivate CTRL


'11
UI --> ADM : show diferent roles and ask to select the employee role
deactivate UI


'12
ADM -> UI : selects the intended role
activate UI
'13
UI --> ADM : request data (i.e., name ,address,phoneNumber,emailAddress,citizenCardNumber)
deactivate UI



'14
ADM -> UI : types requested data
activate UI
'15
UI -> CTRL :newEmployee(name ,address,phoneNumber,\nemailAddress,citizenCardNumber,roleChoice)
activate CTRL
'16
CTRL -> RE : emp = newEmployee(name ,address,phoneNumber,\nemailAddress,citizenCardNumber,roleChoice)
activate RE
'17
RE --> EMP** : create(name ,address,phoneNumber,\nemailAddress,citizenCardNumber)
note over EMP : **emp** might be an instance of Administrator\n or CenterCoordinator or Nurse or Receptionist.\nIt depends of the type of Employee receiving this message
'18
CTRL -> RE : validateEmployee(emp)
'19
RE -> EMP : email = getEmailAddress()
activate EMP
deactivate EMP
'20
RE -> AF : b = existsUser(email)
activate AF
deactivate AF
deactivate CTRL
deactivate RE
'21
UI --> ADM : shows the data and requests a confirmation
deactivate UI


'22
ADM -> UI : confirms
activate UI
'23
UI -> CTRL : registerEmployee()
activate CTRL
'24
CTRL -> RE: registerEmployee(emp)
activate RE
'25
RE -> EMP : email = getEmailAddress()
activate EMP
'26
RE -> EMP : name = getName()

deactivate EMP



'27
RE -> RE : pwd = passwordGenerator(name,email)
activate RE
deactivate RE

'28
RE -> AF : b = addUserWithRole(name,email,pwd,roleChoice)
activate AF
deactivate AF

'29
RE -> RE : addEmployee(emp)
activate RE
deactivate RE
deactivate RE
deactivate CTRL

'30
UI --> ADM : informs operation success
deactivate UI


deactivate ADM


@enduml